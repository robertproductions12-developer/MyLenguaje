<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary Voice Controller</title>
    <style>
        body {
            background-color: #050505;
            color: #00ff41;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            text-align: center;
        }
        #display-binario {
            font-size: 3rem;
            letter-spacing: 10px;
            margin: 20px;
            text-shadow: 0 0 15px #00ff41;
            min-height: 1.2em;
        }
        .instrucciones {
            color: #888;
            font-size: 0.9rem;
            border: 1px solid #333;
            padding: 15px;
            border-radius: 5px;
        }
        #btnEscuchar {
            background: none;
            border: 2px solid #00ff41;
            color: #00ff41;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }
        #btnEscuchar.active {
            background: #00ff41;
            color: black;
            box-shadow: 0 0 20px #00ff41;
        }
        .log {
            font-size: 0.8rem;
            color: #008f11;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>BINARY_INPUT_V1.0</h1>
    
    <div id="display-binario">____</div>
    
    <button id="btnEscuchar">INICIAR ESCUCHA</button>

    <div class="instrucciones">
        <strong>Diccionario de Comandos:</strong><br>
        "0 0 1" -> Abrir Google<br>
        "0 1 0" -> Activar Cámara<br>
        "0 1 1" -> Decir la Hora<br>
        "1 1 1" -> Vibrar Celular<br>
        <p style="color: #00ff41;">Di "CERO" o "UNO". Pausa para ejecutar.</p>
    </div>

    <div id="log" class="log">Esperando sistema...</div>

    <script>
        // --- CONFIGURACIÓN DEL IDIOMA BINARIO ---
        const DICCIONARIO_BINARIO = {
            "001": () => { hablar("Abriendo buscador"); window.open("https://google.com"); },
            "010": () => { hablar("Cámara activada"); activarCamara(); },
            "011": () => { hablar("Son las " + new Date().toLocaleTimeString()); },
            "111": () => { hablar("Alerta"); window.navigator.vibrate([500, 200, 500]); }
        };

        let cadenaActual = "";
        let timeoutEjecucion;

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'es-ES';
        recognition.continuous = true;
        recognition.interimResults = false;

        const btn = document.getElementById('btnEscuchar');
        const display = document.getElementById('display-binario');
        const log = document.getElementById('log');

        btn.onclick = () => {
            if (btn.classList.contains('active')) {
                recognition.stop();
                btn.classList.remove('active');
                btn.innerText = "INICIAR ESCUCHA";
            } else {
                recognition.start();
                btn.classList.add('active');
                btn.innerText = "SISTEMA ACTIVO";
                cadenaActual = "";
                display.innerText = "____";
            }
        };

        recognition.onresult = (event) => {
            const result = event.results[event.results.length - 1][0].transcript.toLowerCase();
            log.innerText = "Escuchado: " + result;

            // Procesamos las palabras para extraer ceros y unos
            if (result.includes("cero") || result.includes("0")) {
                cadenaActual += "0";
            } 
            if (result.includes("uno") || result.includes("1")) {
                cadenaActual += "1";
            }

            display.innerText = cadenaActual;

            // Esperar 2 segundos de silencio para ejecutar el comando
            clearTimeout(timeoutEjecucion);
            timeoutEjecucion = setTimeout(ejecutarComando, 2000);
        };

        function ejecutarComando() {
            if (cadenaActual === "") return;

            log.innerText = "Procesando código: " + cadenaActual;
            
            if (DICCIONARIO_BINARIO[cadenaActual]) {
                DICCIONARIO_BINARIO[cadenaActual]();
            } else {
                hablar("Código binario no asignado");
            }

            // Reiniciar para el siguiente comando
            setTimeout(() => {
                cadenaActual = "";
                display.innerText = "____";
            }, 1000);
        }

        function hablar(texto) {
            const ut = new SpeechSynthesisUtterance(texto);
            ut.lang = 'es-ES';
            window.speechSynthesis.speak(ut);
        }

        function activarCamara() {
            const video = document.createElement('video');
            video.style.width = "100%";
            document.body.appendChild(video);
            navigator.mediaDevices.getUserMedia({ video: true }).then(s => {
                video.srcObject = s;
                video.play();
            });
        }

        recognition.onerror = (e) => {
            log.innerText = "Error: " + e.error;
        };
    </script>
</body>
</html>
